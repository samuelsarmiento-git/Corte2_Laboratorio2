<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Historia Cl√≠nica - {{ paciente.primerNombre }} {{ paciente.primerApellido }}</title>

<style>
    body {
        font-family: "Segoe UI", Arial, sans-serif;
        margin: 40px;
        color: #333;
    }

    h1, h2 {
        color: #0056a6;
        border-bottom: 2px solid #0056a6;
        padding-bottom: 4px;
    }

    .section { margin-top: 28px; }

    .box {
        border: 1px solid #cdd6e2;
        padding: 12px;
        border-radius: 8px;
        background: #f9fbfd;
        margin-top: 10px;
    }

    .label {
        font-weight: bold;
        color: #003d6b;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
    }

    td {
        padding: 6px;
        vertical-align: top;
    }

    /* ============================
       ENCABEZADO SOLO EN P√ÅGINA 1
       ============================ */
    .header {
        width: 100%;
        display: flex;
        align-items: center;
        border-bottom: 3px solid #0056a6;
        padding-bottom: 10px;
        margin-bottom: 25px;
    }

    .header-logo {
        height: 48px;   /* Logo m√°s peque√±o */
        margin-right: 15px;
    }

    /* Ocultar header en p√°ginas siguientes */
    @media print {
        .header {
            position: running(header1);
        }

        @page {
            @top-center {
                content: element(header1);
            }
        }
    }

    /* ============================
       PIE DE P√ÅGINA EN TODAS LAS P√ÅGINAS
       ============================ */
    footer {
        position: fixed;
        bottom: 0;
        width: 100%;
        border-top: 1px solid #ccc;
        padding: 10px 0;
        text-align: center;
        font-size: 12px;
        background: white;
    }

    @media print {
        footer {
            position: running(footerContent);
        }

        @page {
            @bottom-center {
                content: element(footerContent);
            }
        }

        .no-print {
            display: none !important;
        }

        body {
            margin-top: 40mm;
            margin-bottom: 25mm;
        }
    }

    .btn-pdf {
        margin-top: 40px;
        padding: 12px 20px;
        background: #c62828;
        color: white;
        font-weight: bold;
        border: none;
        border-radius: 6px;
        cursor: pointer;
    }
</style>

</head>
<body>

<!-- ============================
     HEADER SOLO EN LA PRIMERA P√ÅGINA
     ============================ -->
<div class="header">
    <img src="{{ logo_path }}" class="header-logo">
    <div>
        <strong style="font-size:20px;">Historia Cl√≠nica</strong><br>
        Sistema FHIR ‚Äî Registro M√©dico Unificado
    </div>
</div>

<!-- ============================
     FOOTER PARA TODAS LAS P√ÅGINAS
     ============================ -->
<footer>
    Desarrollado con Sistemas FHIR ‚Äî P√°gina <span class="pageNumber"></span>
</footer>

<script>
document.addEventListener("DOMContentLoaded", () => {
    document.querySelector(".pageNumber").textContent = "1";
});
</script>

<!-- ============================
     CONTENIDO PRINCIPAL
     ============================ -->
<div>

<h1>Historia Cl√≠nica del Paciente</h1>

<div class="box">
    <p><strong>Paciente:</strong> {{ paciente.primerNombre }} {{ paciente.segundoNombre }} {{ paciente.primerApellido }} {{ paciente.segundoApellido }}</p>
    <p><strong>ID:</strong> {{ paciente.id }}</p>
</div>

<!-- DATOS DEL PACIENTE -->
<div class="section">
    <h2>Datos del Paciente</h2>
    <table>
        <tr><td class="label">Edad:</td><td>{{ paciente.edad }}</td></tr>
        <tr><td class="label">G√©nero:</td><td>{{ paciente.sexo }}</td></tr>
        <tr><td class="label">Ciudad:</td><td>{{ paciente.municipio }}</td></tr>
        <tr><td class="label">Departamento:</td><td>{{ paciente.departamento }}</td></tr>
        <tr><td class="label">Correo:</td><td>{{ paciente.correo }}</td></tr>
        <tr><td class="label">Tel√©fono:</td><td>{{ paciente.telefono }}</td></tr>
        <tr><td class="label">Ocupaci√≥n:</td><td>{{ paciente.ocupacion }}</td></tr>
        <tr><td class="label">EPS:</td><td>{{ paciente.eps }}</td></tr>
        <tr><td class="label">R√©gimen:</td><td>{{ paciente.regimen }}</td></tr>
        <tr><td class="label">Contacto emergencia:</td><td>{{ paciente.contactoEmergencia }}</td></tr>
        <tr><td class="label">Pa√≠s:</td><td>{{ paciente.pais }}</td></tr>
    </table>
</div>

{% if historia %}

<!-- CONDICI√ìN M√âDICA -->
<div class="section">
    <h2>Condici√≥n M√©dica</h2>
    <div class="box">
        <p><span class="label">Condici√≥n:</span> {{ historia.condicionMedica.condicion }}</p>
        <p><span class="label">Estado cl√≠nico:</span> {{ historia.condicionMedica.estadoClinico }}</p>
        <p><span class="label">Fecha inicio:</span> {{ historia.condicionMedica.fechaInicio }}</p>
        <p><span class="label">Notas:</span> {{ historia.condicionMedica.notas }}</p>
    </div>
</div>

<!-- ENCUENTRO -->
<div class="section">
    <h2>Encuentro</h2>
    <div class="box">
        <p><span class="label">Tipo:</span> {{ historia.encuentro.tipo }}</p>
        <p><span class="label">Motivo:</span> {{ historia.encuentro.motivo }}</p>
        <p><span class="label">Inicio:</span> {{ historia.encuentro.fechaInicio }}</p>
        <p><span class="label">Fin:</span> {{ historia.encuentro.fechaFin }}</p>
    </div>
</div>

<!-- MEDICAMENTO -->
<div class="section">
    <h2>Medicamento</h2>
    <div class="box">
        <p><span class="label">Nombre:</span> {{ historia.medicamento.nombre }}</p>
        <p><span class="label">Dosis:</span> {{ historia.medicamento.dosisMg }}</p>
        <p><span class="label">Frecuencia:</span> {{ historia.medicamento.frecuenciaDia }}</p>
        <p><span class="label">V√≠a:</span> {{ historia.medicamento.via }}</p>
        <p><span class="label">Duraci√≥n:</span> {{ historia.medicamento.duracionDias }}</p>
        <p><span class="label">Instrucciones:</span> {{ historia.medicamento.instrucciones }}</p>
    </div>
</div>

<!-- OBSERVACIONES -->
<div class="section">
    <h2>Observaciones</h2>
    <div class="box">
        <p><span class="label">Descripci√≥n:</span> {{ historia.observacion.descripcion }}</p>
        <p><span class="label">Valor:</span> {{ historia.observacion.valor }}</p>
        <p><span class="label">Unidad:</span> {{ historia.observacion.unidad }}</p>
        <p><span class="label">Fecha:</span> {{ historia.observacion.fechaHora }}</p>
        <p><span class="label">Dispositivo:</span> {{ historia.observacion.dispositivo }}</p>
        <p><span class="label">Notas:</span> {{ historia.observacion.notas }}</p>
    </div>
</div>

{% else %}
<h2>Sin historia cl√≠nica registrada</h2>
{% endif %}

<!-- BOT√ìN PARA EXPORTAR -->
<button class="btn-pdf no-print" onclick="window.print()">
    üñ®Ô∏è Exportar PDF
</button>

</div>

</body>
</html>
