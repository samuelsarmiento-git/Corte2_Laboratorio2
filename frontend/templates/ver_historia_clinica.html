<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Historia Cl√≠nica</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body { background:#eef3f7; font-family:"Segoe UI"; }
        header { background:#0078d7; color:white; padding:1rem; text-align:center; font-weight:700; }
        .card { padding:1.5rem; border-radius:12px; }
        .section-title { background:#0078d7; color:white; padding:6px 12px; border-radius:8px; margin-top:25px; }
        .info-box { background:white; padding:12px; border-radius:10px; box-shadow:0 2px 6px rgba(0,0,0,0.15); }
        .label { font-weight:bold; }
    </style>
</head>
<body>

<header>üìÑ HISTORIA CL√çNICA DEL PACIENTE</header>

<div class="container mt-4">
    <div class="card shadow">

        <h3 class="text-center text-primary">
            {{ paciente.primerNombre }} {{ paciente.primerApellido }} {{ paciente.segundoApellido }}
        </h3>

        <h5 class="text-center text-muted">ID Paciente: {{ paciente.id }}</h5>

        <!-- ===================== -->
        <!-- DATOS DEL PACIENTE -->
        <!-- ===================== -->
        <div class="section-title">üë§ Datos del Paciente</div>

        <div class="info-box">
            <p><span class="label">Nombres:</span> {{ paciente.primerNombre }} {{ paciente.segundoNombre }}</p>
            <p><span class="label">Apellidos:</span> {{ paciente.primerApellido }} {{ paciente.segundoApellido }}</p>
            <p><span class="label">Edad:</span> {{ paciente.edad }}</p>
            <p><span class="label">G√©nero:</span> {{ paciente.sexo }}</p>
            <p><span class="label">Ciudad:</span> {{ paciente.municipio }}</p>
            <p><span class="label">Departamento:</span> {{ paciente.departamento }}</p>
            <p><span class="label">Correo:</span> {{ paciente.correo }}</p>
            <p><span class="label">Tel√©fono:</span> {{ paciente.telefono }}</p>
            <p><span class="label">Ocupaci√≥n:</span> {{ paciente.ocupacion }}</p>
            <p><span class="label">EPS:</span> {{ paciente.eps }}</p>
            <p><span class="label">R√©gimen:</span> {{ paciente.regimen }}</p>
            <p><span class="label">Usuario:</span> {{ paciente.tipoUsuario }}</p>
            <p><span class="label">Contacto emergencia:</span> {{ paciente.contactoEmergencia }}</p>
            <p><span class="label">Pa√≠s:</span> {{ paciente.pais }}</p>
        </div>

        {% if historia %}
        
            <!-- ===================== -->
            <!-- CONDICI√ìN M√âDICA -->
            <!-- ===================== -->
            <div class="section-title">ü©∫ Condici√≥n M√©dica</div>
            <div class="info-box">
                <p><span class="label">Condici√≥n:</span> {{ historia.condicionMedica.condicion }}</p>
                <p><span class="label">Estado cl√≠nico:</span> {{ historia.condicionMedica.estadoClinico }}</p>
                <p><span class="label">Fecha inicio:</span> {{ historia.condicionMedica.fechaInicio }}</p>
                <p><span class="label">Notas:</span> {{ historia.condicionMedica.notas }}</p>
            </div>

            <!-- ===================== -->
            <!-- ENCUENTRO -->
            <!-- ===================== -->
            <div class="section-title">üßæ Encuentro</div>
            <div class="info-box">
                <p><span class="label">Tipo:</span> {{ historia.encuentro.tipo }}</p>
                <p><span class="label">Motivo:</span> {{ historia.encuentro.motivo }}</p>
                <p><span class="label">Inicio:</span> {{ historia.encuentro.fechaInicio }}</p>
                <p><span class="label">Fin:</span> {{ historia.encuentro.fechaFin }}</p>
            </div>

            <!-- ===================== -->
            <!-- MEDICAMENTO -->
            <!-- ===================== -->
            <div class="section-title">üíä Medicamento</div>
            <div class="info-box">
                <p><span class="label">Nombre:</span> {{ historia.medicamento.nombre }}</p>
                <p><span class="label">Dosis:</span> {{ historia.medicamento.dosisMg }}</p>
                <p><span class="label">Frecuencia/d√≠a:</span> {{ historia.medicamento.frecuenciaDia }}</p>
                <p><span class="label">V√≠a:</span> {{ historia.medicamento.via }}</p>
                <p><span class="label">Duraci√≥n:</span> {{ historia.medicamento.duracionDias }}</p>
                <p><span class="label">Instrucciones:</span> {{ historia.medicamento.instrucciones }}</p>
            </div>

            <!-- ===================== -->
            <!-- OBSERVACI√ìN -->
            <!-- ===================== -->
            <div class="section-title">üìù Observaci√≥n</div>
            <div class="info-box">
                <p><span class="label">Descripci√≥n:</span> {{ historia.observacion.descripcion }}</p>
                <p><span class="label">Valor:</span> {{ historia.observacion.valor }}</p>
                <p><span class="label">Unidad:</span> {{ historia.observacion.unidad }}</p>
                <p><span class="label">Fecha y hora:</span> {{ historia.observacion.fechaHora }}</p>
                <p><span class="label">Dispositivo:</span> {{ historia.observacion.dispositivo }}</p>
                <p><span class="label">Notas:</span> {{ historia.observacion.notas }}</p>
            </div>

        {% else %}

            <div class="section-title">ü©∫ Condici√≥n M√©dica</div>
            <p class="text-danger fw-bold">A√∫n no existe historia cl√≠nica registrada.</p>

        {% endif %}

        <!-- ===================== -->
        <!-- BOTONES DE ACCI√ìN -->
        <!-- ===================== -->
        <div class="d-flex justify-content-between mt-4">

            <!-- Volver -->
            <a href="{{ url_for('vista_medico') }}" class="btn btn-secondary px-4 py-2">
                ‚¨ÖÔ∏è Volver
            </a>

            <!-- Editar -->
            <a href="{{ url_for('editar_historia_clinica') }}?id={{ paciente.id }}"
               class="btn btn-primary px-4 py-2">
                ‚úèÔ∏è Editar datos
            </a>

            <!-- Imprimir -->
            <button class="btn btn-danger px-4" onclick="abrirModalImprimir()">
            üñ®Ô∏è IMPRIMIR PDF
            </button>

        </div>

    </div>
</div>


<!-- ===================== -->
<!-- MODAL CONFIRMAR IMPRESI√ìN -->
<!-- ===================== -->
<div id="modalImprimir" class="modal" style="display:none;">
    <div class="modal-content">
        <h4>Confirmar impresi√≥n</h4>
        <p>¬øDesea generar la historia cl√≠nica en PDF?</p>

        <button class="btn btn-secondary" onclick="cerrarModal()">Cancelar</button>
        <button class="btn btn-primary" onclick="confirmarImpresion()">S√≠, imprimir</button>
    </div>
</div>

<style>
.modal {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    display:flex;
    justify-content:center;
    align-items:center;
    background:rgba(0,0,0,0.5);
    z-index:9999;
}

.modal-content{
    background:white;
    padding:20px;
    border-radius:8px;
    text-align:center;
    width:300px;
}
</style>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
    const modalImprimir = new bootstrap.Modal(document.getElementById('modalImprimir'));

    function abrirModalImprimir() {
    document.getElementById("modalImprimir").style.display = "flex";
}

function cerrarModal() {
    document.getElementById("modalImprimir").style.display = "none";
}

function confirmarImpresion() {
    const id = "{{ paciente.id }}";
    window.location.href = "/imprimir_historia?id=" + id;
}


</script>

</body>
</html>
